<!-- /*
* Template Name: Blogy
* Template Author: Untree.co
* Template URI: https://untree.co/
* License: https://creativecommons.org/licenses/by/3.0/
*/ -->
{% extends 'base.html' %}
{% load static %}
{% block title %}Hello{% endblock %}
{% block content %}
  <style>
    .sidebar-box *:last-child {
      margin-bottom: 0;
    }

    .post-entry-sidebar ul li a,
    .post-entry-footer ul li a {
      display: table;
      color: #4D4C7D;
    }

    a,
    .btn {
      -webkit-transition: .3s all ease;
      -o-transition: .3s all ease;
      transition: .3s all ease;
      text-decoration: none;
    }

    post-entry-sidebar ul li,
    .post-entry-footer ul li {
      list-style: none;
      padding: 0 0 20px 0;
      margin: 0 0 20px 0;
    }

    .sidebar-box {
      margin-bottom: 4em;
      font-size: 15px;
      width: 100%;
      float: left;
      background: #fff;
    }

    .row {
      --bs-gutter-x: 1.5rem;
      --bs-gutter-y: 0;
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -ms-flex-wrap: wrap;
      flex-wrap: wrap;
      margin-top: calc(-1 * var(--bs-gutter-y));
      margin-right: calc(-.5 * var(--bs-gutter-x));
      margin-left: calc(-.5 * var(--bs-gutter-x));
    }

    .comment-wrap .heading,
    .search-result-wrap .heading {
      font-size: 18px;
      color: #000;
      font-weight: 400;
      margin-bottom: 30px;
      padding-bottom: 20px;
      border-bottom: 1px solid #e6e6e6;
    }
  </style>


  <title>Blogy &mdash; Free Bootstrap 5 Website Template by Untree.co</title>
  <style>
    h1 {
      font-family: "Work Sans", sans-serif;
      letter-spacing: 5px;
    }


    .post-meta .author-figure img {
      width: 30px;
      border-radius: 50%;
    }

    .site-cover,
    .site-cover .same-height {
      padding: 3em 0;
    }

    .form-control {
      height: 54px;
      border-color: rgba(0, 0, 0, 0.1);
      background-color: transparent !important;
      margin-bottom: 10px;
    }

    .sidebar {
      padding-left: 5em;
    }

    .bio img {
      max-width: 150px;
      border-radius: 50%;
    }

    .bio .bio-body h2,
    .bio .bio-body .h2 {
      color: #000;
      font-size: 20px;
    }

    h2 {
      letter-spacing: 0px;
    }


    .sidebar-box .heading {
      margin-top: 60px;
      font-size: 18px;
      color: #000;
      font-weight: 400;
      margin-bottom: 30px;
      padding-bottom: 20px;
      border-bottom: 1px solid #e6e6e6;
    }

    .post-entry-sidebar ul li a img,
    .post-entry-footer ul li a img {
      width: 90px;
    }

    .post-entry-sidebar ul li a,
    .post-entry-footer ul li a {
      display: table;
      color: #4D4C7D;
    }

    .post-entry-sidebar ul li a img,
    .post-entry-sidebar ul li a .text,
    .post-entry-footer ul li a img,
    .post-entry-footer ul li a .text {
      display: table-cell;
      vertical-align: middle;
    }

    .post-entry-sidebar ul li a .text h4,
    .post-entry-sidebar ul li a .text .h4,
    .post-entry-footer ul li a .text h4,
    .post-entry-footer ul li a .text .h4 {
      font-size: 18px;
    }

    .post-meta {
      border: none;
    }

    .post-entry-sidebar ul li,
    .post-entry-footer ul li {
      list-style: none;
      padding: 0 0 20px 0;
      margin: 0 0 20px 0;
    }

    .comment-list li .vcard img {
      width: 50px;
      border-radius: 50%;
    }

    .comment-list li .comment-body h3,
    .comment-list li .comment-body .h3 {
      font-size: 20px;
      color: #000;
      padding-bottom: 8px;
    }

    .comment-list li .comment-body {
      float: right;
      width: calc(100% - 80px);
    }

    .comment-list li {
      padding: 0;
      margin: 0 0 30px 0;
      float: left;
      width: 100%;
      clear: both;
      list-style: none;
    }

    .comment-list li .vcard {
      width: 80px;
      float: left;
    }

    .comment-list li .comment-body .meta {
      text-transform: none;
      color: #ccc;
    }

    .comment-list li .comment-body .reply {
      padding: 3px 10px;
      background: #f2f2f2;
      color: #000;
      font-size: 13px;
    }

    .comment-list .children {
      padding: 50px 0 0 40px;
      margin: 0;
      float: left;
      width: 100%;
    }

    .section {
      padding-top: 4rem;
      padding-bottom: 4rem;
    }

    .text-black {
      --bs-text-opacity: 1;
      color: rgba(var(--bs-black-rgb), var(--bs-text-opacity)) !important;
    }

    .text-uppercase {
      text-transform: uppercase !important;
    }

    .img-fluid {
      max-width: 100%;
      height: auto;
      border-radius: 15px 50px;
    }

    .posts-entry .blog-entry h2 a,
    .posts-entry .blog-entry .h2 a {
      color: #4D4C7D;
    }

    a,
    .btn {
      -webkit-transition: .3s all ease;
      -o-transition: .3s all ease;
      transition: .3s all ease;
      text-decoration: none;
    }

    .posts-entry.posts-entry-sm .blog-entry h2,
    .posts-entry.posts-entry-sm .blog-entry .h2 {
      font-size: 18px;
    }

    h1,
    .h1,
    h2,
    .h2,
    h3,
    .h3,
    h4,
    .h4,
    h5,
    .h5,
    .logo {
      font-family: "Work Sans", sans-serif;
    }

    .posts-entry .blog-entry h2,
    .posts-entry .blog-entry .h2 {
      line-height: 1.3;
      font-size: 26px;
    }

    .read-more {
      border-bottom: 2px solid #214252;
    }

    a {
      color: #214252;

    }

    .form-control-search {
      height: 40px;

    }

    .btn-primary {
      color: #fff;
      background-color: #f50537;
      border-color: #f50537;
    }

    header {
      background-color: #060606;
      padding: 0;
      transition: all 0.4s ease 0s;
      height: 90px;
      display: grid;
      align-items: center;
      /* box-shadow: 0 3px 9px rgba(0, 0, 0, 0.05); */
    }

    header.nav-fixed {
      padding: 0;
      top: 0;
      background-color: var(--bg-color);
      height: 80px;
      border-bottom: none;
      box-shadow: 0 3px 6px 0 rgba(0, 0, 0, 0.05);
      z-index: 100 !important;
    }

    .like.liked {
      color: var(--primary-color);
    }
  </style>

<script>
    const csrf_token = "{{ csrf_token }}";
</script>

  <div class="site-cover site-cover-sm same-height overlay single-page"
    style="background-image: url('images/hero_5.jpg');">
    <div class="container">
      <div class="row same-height justify-content-center">
        <div class="col-md-6">
          <div class="post-entry text-center">
            <h1 class="mb-4">Don’t assume your user data in the cloud is safe</h1>
            <div class="post-meta align-items-center text-center">
              <figure class="author-figure mb-0 me-3 d-inline-block"><img src="{% static '/images/Blog_images/person_1.jpg' %}" alt="Image"
                  class="img-fluid"></figure>
              <span class="d-inline-block mt-1">By Carl Atkinson</span>
              <span>&nbsp;-&nbsp; February 10, 2019</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <section class="section">
    <div class="container">

      <div class="row blog-entries element-animate">

        <div class="col-md-12 col-lg-8 main-content">

          <div class="post-content-body">
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Praesentium nam quas inventore, ut iure iste
              modi eos adipisci ad ea itaque labore earum autem nobis et numquam, minima eius. Nam eius, non unde ut aut
              sunt eveniet rerum repellendus porro.</p>
            <p>Sint ab voluptates itaque, ipsum porro qui obcaecati cumque quas sit vel. Voluptatum provident id quis
              quo. Eveniet maiores perferendis officia veniam est laborum, expedita fuga doloribus natus repellendus
              dolorem ab similique sint eius cupiditate necessitatibus, magni nesciunt ex eos.</p>
            <p>Quis eius aspernatur, eaque culpa cumque reiciendis, nobis at earum assumenda similique ut? Aperiam vel
              aut, ex exercitationem eos consequuntur eaque culpa totam, deserunt, aspernatur quae eveniet hic provident
              ullam tempora error repudiandae sapiente illum rerum itaque voluptatem. Commodi, sequi.</p>
            <div class="row my-4">
              <div class="col-md-12 mb-4">
                <img src="/assets/images/hero_1.jpg" alt="Image placeholder" class="img-fluid rounded">
              </div>
              <div class="col-md-6 mb-4">
                <img src="/assets/images/img_1_horizontal.jpg" alt="Image placeholder" class="img-fluid rounded">
              </div>
              <div class="col-md-6 mb-4">
                <img src="/assets/images/img_3_horizontal.jpg" alt="Image placeholder" class="img-fluid rounded">
              </div>
            </div>
            <p>Quibusdam autem, quas molestias recusandae aperiam molestiae modi qui ipsam vel. Placeat tenetur
              veritatis tempore quos impedit dicta, error autem, quae sint inventore ipsa quidem. Quo voluptate quisquam
              reiciendis, minus, animi minima eum officia doloremque repellat eos, odio doloribus cum.</p>
            <p>Temporibus quo dolore veritatis doloribus delectus dolores perspiciatis recusandae ducimus, nisi quod,
              incidunt ut quaerat, magnam cupiditate. Aut, laboriosam magnam, nobis dolore fugiat impedit necessitatibus
              nisi cupiditate, quas repellat itaque molestias sit libero voluptas eveniet omnis illo ullam dolorem
              minima.</p>
            <p>Porro amet accusantium libero fugit totam, deserunt ipsa, dolorem, vero expedita illo similique saepe
              nisi deleniti. Cumque, laboriosam, porro! Facilis voluptatem sequi nulla quidem, provident eius quos
              pariatur maxime sapiente illo nostrum quibusdam aliquid fugiat! Earum quod fuga id officia.</p>
            <p>Illo magnam at dolore ad enim fugiat ut maxime facilis autem, nulla cumque quis commodi eos nisi unde
              soluta, ipsa eius aspernatur sint atque! Nihil, eveniet illo ea, mollitia fuga accusamus dolor dolorem
              perspiciatis rerum hic, consectetur error rem aspernatur!</p>

            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Temporibus magni explicabo id molestiae, minima
              quas assumenda consectetur, nobis neque rem, incidunt quam tempore perferendis provident obcaecati
              sapiente, animi vel expedita omnis quae ipsa! Obcaecati eligendi sed odio labore vero reiciendis facere
              accusamus molestias eaque impedit, consequuntur quae fuga vitae fugit?</p>
          </div>


          <div class="pt-5">
            <p>Categories: <a href="#">Food</a>, <a href="#">Travel</a> Tags: <a href="#">#manila</a>, <a
                href="#">#asia</a></p>
          </div>


          <div class="pt-5 comment-wrap">
            <h3 id="commentCount" class="mb-5 heading">{{ comment_count }} Comments</h3>
              <form method="post" id="commentForm" action="{% url 'blog_comment' post_title=post.title %}" class="">
                {% csrf_token %}
                <input type="hidden" name="post_title" value="{{ post.title }}">
                {% if form.errors %}
                    <div class="alert alert-danger" role="alert">
                        <strong>Form is not valid. Errors:</strong>
                        {{ form.errors }}
                    </div>
                {% endif %}
                <textarea name="content" id="content" cols="30" rows="10" class="form-control"></textarea>
                <input type="submit" value="Post Comment" class="btn btn-primary">
              </form>  
            <ul id="commentList" class="comment-list">
              {% for comment in comments %}
                  <li class="comment">
                      <div class="vcard">
                          <img src="/assets/images/person_1.jpg" alt="Image placeholder">
                      </div>
                      <div class="comment-body">
                          <h3>{{ comment.author.username }}</h3>
                          <div class="meta">{{ comment.created_at }}</div>
                          <p>{{ comment.content }}</p>
                          <p>
                              <a href="#" class="like rounded {% if user in comment.likes.all %}liked{% endif %}"
                                  onclick="toggleLike('{{ post.title }}', {{ comment.id }}, event)">
                                  <i class="fas fa-heart"></i> 
                                  <span id="likeCount{{ comment.id }}">{{ comment.likes.count }}</span>
                              </a>
                          </p>
                      </div>
                  </li>
              {% endfor %}
            </ul>
          </div>
          
          <script>
            document.getElementById('commentForm').addEventListener('submit', function (event) {
                event.preventDefault();
                const formData = new FormData(this);
        
                fetch(this.action, {
                    method: 'POST',
                    credentials: 'same-origin',
                    headers: {
                        'X-CSRFToken': csrf_token,
                    },
                    body: formData,
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(data => {
                    // Update comment list with the new comment
                    const commentList = document.getElementById('commentList');
                    commentList.innerHTML = data.comments_html;
                    const commentCountElement = document.getElementById('commentCount');
                    commentCountElement.textContent = `${data.comment_count} Comments`;
                    // Clear the form
                    this.reset();
                })
                .catch(error => console.error('Error submitting comment:', error));
            });
 

        </script>
        
        
        
            
          <script>
            function toggleLike(postTitle, commentId, event) {
              event.preventDefault();

              const likeCountElement = document.querySelector(`#likeCount${commentId}`);
              const likeLinkElement = likeCountElement.closest('a');

              fetch(`/blog/${postTitle}/comment/${commentId}/like/`, {
                  method: 'POST',
                  credentials: 'same-origin',
                  headers: {
                      'Content-Type': 'application/json',
                      'X-CSRFToken': csrf_token,
                  },
                  body: JSON.stringify({}),
              })
              .then(response => response.json())
              .then(data => {
                  console.log('Before Update - isLiked:', likeLinkElement.classList.contains('liked'));

                  likeCountElement.textContent = data.like_count;

                  // Kiểm tra xem có thích hay không
                  const isLiked = data.is_liked;

                  console.log('After Update - isLiked:', isLiked);

                  // Cập nhật class 'liked' để giữ màu trái tim
                  if (isLiked) {
                      console.log('Adding class "liked"');
                      likeLinkElement.classList.add('liked');
                  } else {
                      console.log('Removing class "liked"');
                      likeLinkElement.classList.remove('liked');
                  }
              })
              .catch(error => {
                  console.error('Lỗi trong yêu cầu AJAX:', error);
              });
            }
          </script> 
        </div>

        </div>
        <!-- END main-content -->

        <div class="col-md-12 col-lg-4 sidebar">

          <!-- END sidebar-box -->
          <div class="sidebar-box">
            <div class="bio text-center">
              <img src="/assets/images/person_2.jpg" alt="Image Placeholder" class="img-fluid mb-3">
              <div class="bio-body">
                <h2>Hannah Anderson</h2>
                <p class="mb-4">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Exercitationem facilis sunt
                  repellendus excepturi beatae porro debitis voluptate nulla quo veniam fuga sit molestias minus.</p>
                <p><a href="#" class="btn btn-primary btn-sm rounded px-2 py-2">Read my bio</a></p>
                <p class="social">
                  <a href="#" class="p-2"><span class="fa fa-facebook"></span></a>
                  <a href="#" class="p-2"><span class="fa fa-twitter"></span></a>
                  <a href="#" class="p-2"><span class="fa fa-instagram"></span></a>
                  <a href="#" class="p-2"><span class="fa fa-youtube-play"></span></a>
                </p>
              </div>
            </div>
          </div>
          <!-- END sidebar-box -->
          <div class="sidebar-box">
            <h3 class="heading">Popular Posts</h3>
            <div class="post-entry-sidebar">
              <ul>
                <li>
                  <a href="">
                    <img src="/assets/images/img_1_sq.jpg" alt="Image placeholder" class="me-4 rounded">
                    <div class="text">
                      <h4>There’s a Cool New Way for Men to Wear Socks and Sandals</h4>
                      <div class="post-meta">
                        <span class="mr-2">March 15, 2018 </span>
                      </div>
                    </div>
                  </a>
                </li>
                <li>
                  <a href="">
                    <img src="assets/images/img_2_sq.jpg" alt="Image placeholder" class="me-4 rounded">
                    <div class="text">
                      <h4>There’s a Cool New Way for Men to Wear Socks and Sandals</h4>
                      <div class="post-meta">
                        <span class="mr-2">March 15, 2018 </span>
                      </div>
                    </div>
                  </a>
                </li>
                <li>
                  <a href="">
                    <img src="assets/images/img_3_sq.jpg" alt="Image placeholder" class="me-4 rounded">
                    <div class="text">
                      <h4>There’s a Cool New Way for Men to Wear Socks and Sandals</h4>
                      <div class="post-meta">
                        <span class="mr-2">March 15, 2018 </span>
                      </div>
                    </div>
                  </a>
                </li>
              </ul>
            </div>
          </div>
          <!-- END sidebar-box -->

          <div class="sidebar-box">
            <h3 class="heading">Categories</h3>
            <ul class="categories">
              <li><a href="#">Food <span>(12)</span></a></li>
              <li><a href="#">Travel <span>(22)</span></a></li>
              <li><a href="#">Lifestyle <span>(37)</span></a></li>
              <li><a href="#">Business <span>(42)</span></a></li>
              <li><a href="#">Adventure <span>(14)</span></a></li>
            </ul>
          </div>
          <!-- END sidebar-box -->

          <div class="sidebar-box">
            <h3 class="heading">Tags</h3>
            <ul class="tags">
              <li><a href="#">Travel</a></li>
              <li><a href="#">Adventure</a></li>
              <li><a href="#">Food</a></li>
              <li><a href="#">Lifestyle</a></li>
              <li><a href="#">Business</a></li>
              <li><a href="#">Freelancing</a></li>
              <li><a href="#">Travel</a></li>
              <li><a href="#">Adventure</a></li>
              <li><a href="#">Food</a></li>
              <li><a href="#">Lifestyle</a></li>
              <li><a href="#">Business</a></li>
              <li><a href="#">Freelancing</a></li>
            </ul>
          </div>
        </div>
        <!-- END sidebar -->

      </div>
    </div>
  </section>


  <!-- Start posts-entry -->
  <section class="section posts-entry posts-entry-sm bg-light">
    <div class="container">
      <div class="row mb-4">
        <div class="col-12 text-uppercase text-black">More Blog Posts</div>
      </div>
      <div class="row">
        <div class="col-md-6 col-lg-3">
          <div class="blog-entry">
            <a href="single.html" class="img-link">
              <img src="assets/images/img_1_horizontal.jpg" alt="Image" class="img-fluid">
            </a>
            <span class="date">Apr. 14th, 2022</span>
            <h2><a href="single.html">Thought you loved Python? Wait until you meet Rust</a></h2>
            <p>Lorem ipsum dolor sit amet consectetur adipisicing elit.</p>
            <p><a href="#" class="read-more">Continue Reading</a></p>
          </div>
        </div>
        <div class="col-md-6 col-lg-3">
          <div class="blog-entry">
            <a href="single.html" class="img-link">
              <img src="assets/images/img_2_horizontal.jpg" alt="Image" class="img-fluid">
            </a>
            <span class="date">Apr. 14th, 2022</span>
            <h2><a href="single.html">Startup vs corporate: What job suits you best?</a></h2>
            <p>Lorem ipsum dolor sit amet consectetur adipisicing elit.</p>
            <p><a href="#" class="read-more">Continue Reading</a></p>
          </div>
        </div>
        <div class="col-md-6 col-lg-3">
          <div class="blog-entry">
            <a href="single.html" class="img-link">
              <img src="assets/images/img_3_horizontal.jpg" alt="Image" class="img-fluid">
            </a>
            <span class="date">Apr. 14th, 2022</span>
            <h2><a href="single.html">UK sees highest inflation in 30 years</a></h2>
            <p>Lorem ipsum dolor sit amet consectetur adipisicing elit.</p>
            <p><a href="#" class="read-more">Continue Reading</a></p>
          </div>
        </div>
        <div class="col-md-6 col-lg-3">
          <div class="blog-entry">
            <a href="single.html" class="img-link">
              <img src="assets/images/img_4_horizontal.jpg" alt="Image" class="img-fluid">
            </a>
            <span class="date">Apr. 14th, 2022</span>
            <h2><a href="single.html">Don’t assume your user data in the cloud is safe</a></h2>
            <p>Lorem ipsum dolor sit amet consectetur adipisicing elit.</p>
            <p><a href="#" class="read-more">Continue Reading</a></p>
          </div>
        </div>
      </div>
    </div>
  </section>
{% endblock %}